<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
    <ui:composition>
        <link type="text/css" rel="stylesheet" href="#{request.contextPath}/programs/file/search.css" />
        <h:panelGroup layout="block" id="search-main">
            <h:form id="search-form">
                <!--This is the search criteria form-->
                <h:panelGroup layout="block" id="search-criteria" class="panel">
                    <p:panelGrid id="search-criteria-table" columns="2" columnClasses="criteria-columns">
                        <f:facet name="header">Search Criteria</f:facet>
                        
                        <p:outputLabel value="Filename: " />
                        <p:inputText id="filename">
                            <p:ajax event="keyup" update="search-results-list" listener="#{ProgramFile.newEntitySearch.search}"
                                    />
                        </p:inputText>
                        
                        <p:outputLabel value="Uploaded since: " />
                        <p:calendar pattern="dd.MM.yyyy" />
                        
                        <p:outputLabel value="Uploaded before: " />
                        <p:calendar pattern="dd.MM.yyyy" />
                        
                        <f:facet name="footer"> 
                            <p:commandButton value="Search" update="search-results-list" action="#{ProgramFile.newEntitySearch.search}">
                                
                            </p:commandButton>
                            <p:commandButton value="Reset" update="search-results-list" action="#{ProgramFile.newEntitySearch.reset}" />
                        </f:facet> 

                    </p:panelGrid>
                </h:panelGroup>
                
                <!--This is the search result list panel-->
                <h:panelGroup layout="block" id="search-results" class="panel">
                    <p:panelGrid id="search-results-table" columns="1">
                        <f:facet name="header">Search Result</f:facet>
                        <p:ajaxStatus id="ajaxStatusPanel">
                            <f:facet name="start">
                                <img src="#{request.contextPath}/programs/file/ajax_loader.gif" class="ajax-large" />
                                 <!--<h:graphicImage name="ajax_loader.gif" />-->
                            </f:facet>

                            <f:facet name="complete">
                                <p:accordionPanel id="search-results-list" var="file" value="#{ProgramFile.newEntitySearch.results}"  >
                                    <p:tab title="#{file.FILENAME} - Uploaded by #{file.CREATED_BY} on the #{file.DATE_CREATED}">

                                        <p:commandButton value="Manage File/Sequences" update=":subprogram" id="manage"  
                                            styleClass="ui-priority-primary"
                                            action="#{ProgramFile.manageEntity}">
                                            <f:setPropertyActionListener target="#{ProgramFile.subprogram}" 
                                                                         value="manage" />
                                            <f:setPropertyActionListener target="#{ProgramFile.selectedEU}" 
                                                                         value="#{file}" />
                                        </p:commandButton>
                                    </p:tab>
                                </p:accordionPanel>
                            </f:facet>
                        </p:ajaxStatus>
                    </p:panelGrid>
                </h:panelGroup>
            </h:form>
        </h:panelGroup>
    </ui:composition>
</html>
