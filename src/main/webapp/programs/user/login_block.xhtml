<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
    <ui:composition>
        <h:panelGroup id="loginbox-container" layout="block" rendered="false">
            <p:dialog id="modalDialog" widgetVar="loginbox" header="#{ProgramUser.userLogin.loginboxTitle}" modal="true" 
                      height="200" width="500"
                      style="" closable="false">  
                <h:form id="login-form">
                    <p:panelGrid id="login-form-table" columns="2">
                        <f:facet name="header">
                            <p:messages id="login-form-messages" showDetail="false" autoUpdate="true"
                                        for="login-form"/>
                        </f:facet>
                        <p:outputLabel value="Username: " />
                        <p:inputText value="#{ProgramUser.userLogin.username}" />
                        
                        <p:outputLabel value="Password: " />
                        <p:password value="#{ProgramUser.userLogin.password}" />
                    </p:panelGrid>
                    
                    
                    <p:commandButton value="Log in" actionListener="#{ProgramUser.userLogin.login()}" 
                                     update=":loginbox-container" />
                </h:form>
            </p:dialog>
            <script type="text/javascript">
               //window.alert("sometext");
               $(document).ready(function() {
                   if (typeof (Storage) != "undefined")
                   {
                       // Store
                       //localStorage.setItem("loggedIn", });
                       // Retrieve
                       //if (localStorage.getItem("loggedIn") == null ||
                               //localStorage.getItem("loggedIn") == '' ||
                               //localStorage.getItem("loggedIn") == 0) {
                       if(!#{ProgramUser.userLogin.checkSessionActive()}){
                           PF('loginbox').show();
                       } else {
                           PF('loginbox').hide();
                           //window.alert("logged in");
                       }
                    }
                    else
                    {
                        document.getElementById("header").innerHTML = "<br/>Sorry, your browser does not support Web Storage...";
                    }
                });
            </script>
        </h:panelGroup>
    </ui:composition>
</html>
